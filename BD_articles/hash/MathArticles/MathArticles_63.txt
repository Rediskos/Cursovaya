Сеть Фейстеля  ВикипедияянварьфевральмартапрельмайиюньиюльавгустсентябрьоктябрьноябрьдекабрьСетьФейстеляСеть ФейстеляВикипедияХорошие статьи по криптографииВикипедияХорошие статьи по математикеВикипедияХорошие статьи по алфавитуСтраницы использующие волшебные ссылки КриптографияСеть ФейстеляСетьФейстелярусскийСеть ФейстеляМатериал из Википедии  свободной энциклопедииЭто стабильная версия отпатрулированная  января СостояниеотпатрулированаПерейти к навигацииПерейти к поискуСеть Фейстеля или конструкция Фейстеля англ    один из методов построения блочных шифров Сеть состоит из ячеек называемых ячейками Фейстеля На вход каждой ячейки поступают данные и ключ На выходе каждой ячейки получают изменённые данные и изменённый ключ Все ячейки однотипны и говорят что сеть представляет собой определённую многократно повторяющуюся итерированную структуру Ключ выбирается в зависимости от алгоритма шифрованиярасшифрования и меняется при переходе от одной ячейки к другой При шифровании и расшифровании выполняются одни и те же операции отличается только порядок ключей Ввиду простоты операций сеть Фейстеля легко реализовать как программно так и аппаратно Большинство современных блочных шифров           и др использует сеть Фейстеля в качестве основы Альтернативой сети Фейстеля является подстановочноперестановочная сеть  и дрСодержание История Конструкция блочного шифра на основе сетей Фейстеля Простое описание Шифрование Расшифрование Алгоритмическое описание Математическое описание Функции используемые в сетях Фейстеля блок блок Циклический сдвиг Сложение по модулю  Умножение по модулю  Пример реализации на языке Си Достоинства и недостатки Теоретические исследования Модификации сети Фейстеля Алгоритм  Шифры на основе сети Фейстеля Люцифер   Магма Сравнительный список алгоритмов Примечания ЛитератураИсторияправить  править кодВ  году Хорст Фейстель запатентовал два устройства реализующие различные алгоритмы шифрования позже получившие название Люцифер англ Одно из этих устройств использовало конструкцию впоследствии названную сетью Фейстеля англ    Тогда Фейстель работал над созданием новых криптосистем в стенах  вместе с Доном Копперсмитом Проект Люцифер был скорее экспериментальным но стал основой для алгоритма  англ   В  году журнал   опубликовал статью Фейстеля Криптография и компьютерная безопасность англ    в которой раскрыты некоторые важные аспекты шифрования и приведено описание первой версии проекта Люцифер В первой версии проекта Люцифер сеть Фейстеля не использоваласьНа основе сети Фейстеля был спроектирован алгоритм  В  году власти США приняли стандарт   признающий  стандартным методом шифрования данных  некоторое время широко использовался в криптографических системах Итеративная структура алгоритма позволяла создавать простые программные и аппаратные реализацииСогласно некоторым данным в СССР уже в е годы КГБ разрабатывала блочный шифр использовавший сеть Фейстеля и вероятно именно этот шифр в  году был принят в качестве ГОСТ В  году были разработаны алгоритмы  и  Сети Фейстеля получили широкое распространение в е годы в годы появления таких алгоритмов как               и других января  года институт  объявил конкурс по созданию нового алгоритма шифрования данных призванного заменить  Новый блочный шифр получил название  англ   и был утверждён  мая  года В  вместо сети Фейстеля используется подстановочноперестановочная сетьКонструкция блочного шифра на основе сетей Фейстеляправить  править кодПростое описаниеправить  править кодШифрованиеправить  править кодПусть требуется зашифровать некоторую информацию представленную в двоичном виде в виде последовательности нулей и единиц и находящуюся в памяти компьютера или иного устройства например в файлеАлгоритм шифрованияИнформация разбивается на блоки одинаковой фиксированной длины Полученные блоки называются входными так как поступают на вход алгоритма В случае если длина входного блока меньше чем размер который выбранный алгоритм шифрования способен зашифровать единовременно размер блока то блок удлиняется какимлибо способом Как правило длина блока является степенью двойки например составляет  бита или  битДалее будем рассматривать операции происходящие только с одним блоком так как в процессе шифрования с другими блоками выполняются те же самые операцииВыбранный блок делится на два подблока одинакового размера левый   и правый  Правый подблок   изменяется функцией  с использованием раундового ключа   Результат складывается по модулю   с левым подблоком    Результат будет использован в следующем раунде в роли правого подблока   Правый подблок   текущего раунда в своем не измененном на момент начала раунда виде будет использован в следующем раунде в роли левого подблока   По какомулибо математическому правилу вычисляется раундовый ключ   ключ который будет использоваться в следующем раундеПеречисленные операции выполняются  раз где  количество раундов в выбранном алгоритме шифрования При этом между переходами от одного раунда этапа к другому изменяются ключи   заменяется на     на   итдРасшифрованиеправить  править кодРасшифровка информации происходит так же как и шифрование с тем лишь исключением что ключи следуют в обратном порядке то есть не от первого к му а от го к первомуАлгоритмическое описаниеправить  править кодБлок открытого текста делится на две равные части   В каждом раунде вычисляются       где номер раунда    количество раундов в выбранном алгоритме шифрования  некоторая функция  ключ го раунда раундовый ключРезультатом выполнения   раундов является    В м раунде перестановка   и   не производится чтобы была возможность использовать ту же процедуру и для расшифрования просто инвертировав порядок использования ключей    вместо           Небольшим изменением можно добиться и полной идентичности процедур шифрования и расшифрованияДостоинстваобратимость алгоритма независимо от используемой функции возможность выбора сколь угодно сложной функции Математическое описаниеправить  править кодРассмотрим пример Пусть блок данных поступающий на вход входной блок некоторое инволютивное преобразование или инволюция взаимнооднозначное преобразование которое является обратным самому себе то есть для каждого   справедливо выражение   блок данных получаемый на выходе результатПри однократном применении преобразования  к входному блоку  получится выходной блок  При применении преобразования  к результату предыдущего преобразования  получится  Пусть входной блок  состоит из двух подблоков  и  равной длины Определим два преобразования  шифрование данных  с ключом     перестановка подблоков  и  Введём обозначенияоднократное применение преобразования     двукратное применение преобразования        Докажем инволютивность двукратного преобразования   Несложно заметить что преобразование  меняет только левый подблок  оставляя правый  неизменным     Поэтому далее будем рассматривать только подблок  После двукратного применения преобразования  к  получим          Таким образом  следовательно и  инволюцияДокажем инволютивность двукратного преобразования    Рассмотрим процесс шифрования Пусть входное значение  преобразование с ключом    выходное значение результат го раундаТогда преобразование выполняемое на м раунде можно записать в виде Преобразование выполняемое на м раунде Следовательно выходное значение после  раундов шифрования будет равно  Можно заметить что на последнем этапе не обязательно выполнять перестановку Расшифрование ведётся применением всех преобразований в обратном порядке В силу инволютивности каждого из преобразований обратный порядок даёт исходный результат    Функции используемые в сетях Фейстеляправить  править кодВ своей работе Криптография и компьютерная безопасность Хорст Фейстель описывает два блока преобразований функций   блок подстановок блок англблок перестановок блок англМожно показать что любое двоичное преобразование над блоком данных фиксированной длины может быть реализовано в виде блока В силу сложности строения разрядного блока при больших  на практике применяют более простые конструкцииТермин блок в оригинальной статье используется вместо термина функция вследствие того что речь идёт о блочном шифре и предполагалось что  и блоки будут цифровыми микросхемами цифровыми блоками Принципиальная схема разрядного блока Принципиальная схема разрядного блокаблокправить  править кодОсновная статья блокиБлок подстановок блок англ состоит из следующих частейдешифратор преобразователь разрядного двоичного сигнала в одноразрядный сигнал по основанию  система коммутаторов внутренние соединения всего возможных соединений  шифратор преобразователь сигнала из одноразрядного  ричного в разрядный двоичныйАнализ разрядного блока при большом  крайне сложен однако реализовать такой блок на практике очень сложно так как число возможных соединений крайне велико   На практике блок подстановок используется как часть более сложных системВ общем случае блок может иметь несовпадающее число входоввыходов в этом случае в системе коммутации от каждого выхода дешифратора может идти не строго одно соединение а  или более или не идти вовсе То же самое справедливо и для входов шифратораВ электронике можно непосредственно применять приведённую справа схему В программировании же генерируют таблицы замены Оба этих подхода являются эквивалентными то есть файл зашифрованный на компьютере можно расшифровать на электронном устройстве и наоборотТаблица замены для приведённого разрядного блока комбинацииВходВыходблокправить  править кодБлок перестановок блок англ всего лишь изменяет положение цифр и является линейным устройством Этот блок может иметь очень большое количество входоввыходов однако в силу линейности систему нельзя считать криптоустойчивойКриптоанализ ключа для разрядного блока проводится путём подачи на вход  различных сообщений каждое из которых состоит из  нуля  и  единицы  или наоборот из единиц и нуляЦиклический сдвигправить  править кодОсновные статьи Битовые операции и Битовый сдвиг Циклический сдвиг влево на  разряда битной шиныМожно показать что циклический сдвиг является частным случаем блокаВ простейшем случае сдвиг на  бит крайний бит отщепляется и перемещается на другой конец регистра или шины В зависимости от того какой бит берётся правый или левый сдвиг называется вправо или влево Сдвиги на большее число бит можно рассматривать как многократное применение сдвига на Циклический сдвиг на  бит для разрядного входа   Направление сдвигаПорядок следования битов до сдвигаПорядок следования битов после сдвигаВлево  Вправо  Сложение по модулю править  править кодОсновная статья Сравнение по модулюОперация сложение по модулю  обозначается как    и представляет собой остаток от деления суммы    на  где  и  числаМожно показать что сложение двух чисел по модулю  представляется в двоичной системе счисления в виде блока у которого на вход подаётся число  а в качестве системы коммутации блока используется циклический сдвиг влево на  разрядовВ компьютерной технике и электронике операция сложения как правило реализована как сложение по модулю   где  целое обычно  равно разрядности машины Для получения в двоичной системе     достаточно сложить числа после чего отбросить разряды начиная с го и старшеУмножение по модулю править  править кодУмножение по модулю  обозначается как    и представляет собой остаток от деления произведения    на  где  и  числаВ персональных компьютерах на платформе  при перемножении двух разрядных чисел получается число разрядностью  Чтобы получить остаток от деления на   нужно отбросить  старших битПример реализации на языке Сиправить  править кодОбщий вид алгоритма шифрования использующего сеть Фейстеля Функция выполняющая преобразование подблока с учётом значения ключа по ключу Реализация зависит от выбранного алгоритма блочного шифрования               преобразуемый подблок                   ключ    возвращаемое значение  преобразованный блок  Функция выполняющая шифрование открытого текста                 левый входной подблок              правый входной подблок              количество раундов                 массив ключей по ключу на раунд                                                                 Функция выполняющая расшифрование текста                 левый зашифрованный подблок              правый зашифрованный подблок              количество раундов                 массив ключей по ключу на раунд                                                                  Достоинства и недостаткиправить  править кодДостоинствапростота аппаратной реализации на современной электронной базепростота программной реализации в силу того что значительная часть функций поддерживается на аппаратном уровне в современных компьютерах например сложение по модулю   сложение по модулю   умножение по модулю   итдхорошая изученность алгоритмов построенных на основе сетей ФейстеляНедостаткиза один раунд шифруется только половина входного блокаТеоретические исследованияправить  править кодСети Фейстеля были широко изучены криптографами в силу их обширного распространения В  году Майкл Луби и Чарльз Ракофф провели исследования сети Фейстеля и доказали что если раундовая функция является криптостойкой псевдослучайной и используемые ключи независимы в каждом раунде то  раундов будет достаточно для того чтобы блочный шифр являлся псевдослучайной перестановкой тогда как четырёх раундов будет достаточно для того чтобы сделать сильную псевдослучайную перестановкуПсевдослучайной перестановкой Люби и Ракофф назвали такую которая устойчива к атаке с адаптивным выбором открытого текста а сильной псевдослучайной перестановкой псевдослучайную перестановку устойчивую к атаке с использованием выбранного шифрованного текстаИногда в западной литературе сеть Фейстеля называют    в честь Люби и Ракоффа которые проделали большой объём теоретических исследований в этой областиВ дальнейшем в  году Мони Наор и Омер Рейнголд предложили упрощённый вариант конструкции Люби Ракоффа состоящий из четырёх раундов В этом варианте в качестве первого и последнего раунда используются две попарнонезависимые перестановки Два средних раунда конструкции Наора Рейнголда идентичны раундам в конструкции Люби РакоффаБольшинство же исследований посвящено изучению конкретных алгоритмов Во многих блочных шифрах на основе сети Фейстеля были найдены те или иные уязвимости однако в ряде случаев эти уязвимости являются чисто теоретическими и при нынешней производительности компьютеров использовать их на практике для взлома невозможноМодификации сети Фейстеляправить  править кодПри большом размере блоков шифрования  бит и более реализация такой конструкции Фейстеля на разрядных архитектурах может вызвать затруднения поэтому применяются модифицированные варианты этой конструкции Обычно используются сети с четырьмя ветвями На рисунке показаны наиболее распространённые модификации Также существуют схемы в которых длины половинок   и   не совпадают Такие сети называются несбалансированнымиМодификации сети ФейстеляТип Тип Тип Алгоритм править  править кодОсновная статья Источник Схема одной итерацииполного раунда алгоритма В алгоритме  используется глубоко модифицированная сеть Фейстеля В нём битные входные блоки данных обозначим за   делятся на  подблока длиной  бит   На каждом этапе используется  битных ключей Всего используется  основных этапов и  укороченныйФормулы для вычисления значения подблоков на м раунде для раундов  го по йпредварительные вычисления       финальные вычисления                где   й ключ на м раундеФормула для вычисления го раунда            Выходом функции будет Можно заметить что  и блоки в чистом виде не используются В качестве основных операций используютсяумножение по модулю  сложение по модулю  Шифры на основе сети Фейстеляправить  править кодЛюцифер править  править кодОсновная статья  криптография Модуль выбирающий используемую таблицу подстановок по битовому ключу Упрощённая схема  и слоёв в алгоритме Люцифер июнь  Схема генерации и распространения единицИсторически первым алгоритмом использующим сеть Фейстеля был алгоритм Люцифер при работе над которым Фейстелем и была собственно разработана структура впоследствии получившая название сеть Фейстеля В июне  года Фейстелем был получен американский патент Первая версия Люцифера использовала блоки и ключи длиной по  бит и не использовала конструкцию сеть Фейстеля Последующая модификация алгоритма была запатентована на имя Джона Л Смитта англ   в ноябре  года      и в патенте содержится как описание собственно самой сети Фейстеля так и конкретной функции шифрования В ней использовались разрядные ключи и битные блоки И наконец последняя версия предложена в  году и оперировала с битными блоками и ключами Наиболее полное описание алгоритма Люцифер было приведено в статье Артура Соркина англ  Люцифер Криптографический алгоритм     в журнале Криптология  за январь Хотя изначальная модификация Люцифера обходилась без ячеек Фейстеля она хорошо демонстрирует то как только применением  и блоков можно сильно исказить исходный текст Структура алгоритма Люцифер образца июня  года представляет собой сэндвич из слоёв двух типов используемых по очереди так называемые сети или подстановочноперестановочные сети Первый тип слоя блок разрядности  бит за ним идёт второй слой представляющий собой  модуля каждый из которых состоит их двух четырёхбитных блоков чьи соответствующие входы закорочены и на них подаётся одно и то же значение с выхода предыдущего слоя Но сами блоки подстановок различны отличаются таблицами замен На выход модуля подаются значения только с одного из блоков какого конкретно определяется одним из битов в ключе номер которого соответствовал номеру блока в структуре Упрощённая схема алгоритма меньшей разрядности и неполным числом раундов приведена на рисунке В ней используется  модулей выбора блоков всего  блока таким образом такая схема использует битный ключРассмотрим теперь как будет меняться шифротекст в приведённом выше алгоритме при изменении всего одного бита Для простоты возьмём таблицы замен блоков такими что если на вход блока подаются все нули то и на выходе будут все нули В силу нашего выбора блоков если на вход шифрующего устройства подаются все нули то и на выходе устройства будут все нули В реальных системах такие таблицы замен не используются так как они сильно упрощают работу криптоаналитика но в нашем примере они наглядно иллюстрируют сильную межсимвольную взаимосвязь при изменении одного бита шифруемого сообщения Видно что благодаря первому блоку единственная единица сдвигается перемещается в центр блока затем следующий нелинейный блок размножает её и уже две единицы за счёт следующего блока изменяют своё положение итд В конце устройства шифрования благодаря сильной межсимвольной связи выходные биты стали сложной функцией от входных и от используемого ключа В среднем на выходе половина бит будет равна  и половина По своей сути сеть Фейстеля является альтернативой сложным сетям и используется намного шире С теоретической точки зрения раундовая функция шифрования может быть сведена к сети однако сеть Фейстеля является более практичной так как шифрование и дешифрование может вестись одним и тем же устройством но с обратным порядком используемых ключей Вторая и третья версия алгоритма использующие сеть Фейстеля оперировали над битными блоками с битным ключом и битными блоками со битными ключами В последней третьей версии раундовая функция шифрования была устроена очень просто сначала шифруемый подблок пропускался через слой битных блоков аналогично слоям в сетях только блок является константным и не зависит от ключа затем к нему по модулю  добавлялся раундовый ключ после чего результат пропускался через блокправить  править кодОсновная статья Функция   где  разрядный входной блок на й итерации  разрядный ключ на данной итерациив алгоритме  состоит из следующих операцийрасширение входного блока  до  разрядов некоторые входные разряды могут повторятьсяСложение по модулю  с ключом     деление результата на  блоков длиной по  бит каждый          полученные блоки информации    подаются на блоки подстановок имеющие разрядные входы и разрядные выходына выходе битные блоки объединяются в битный который и является результатом функции  Полное число раундов в алгоритме  равно Магмаправить  править кодОсновная статья ГОСТ Функция   где   и   битные числа вычисляется следующим образомскладываются   и   по модулю       результат разбивается на  битных блоков которые подаются на вход разрядных блоков которые могут быть различнымивыходы блоков объединяют в битное число которое затем сдвигается циклически на  битов влевополученный результат является выходом функцииКоличество раундов в алгоритме ГОСТ  равно Сравнительный список алгоритмовправить  править кодСледующие блочные шифры в качестве своей основы используют классическую или модифицированную сеть ФейстеляАлгоритмГодЧисло раундовДлина ключаРазмер блокаКоличество подблоковот  до   ГОСТ  Примечанияправить  править код    Хорст Фейстель    англ Криптография и компьютерная безопасность Перевод Андрея Винокурова   Винокуров А Статья Алгоритм шифрования ГОСТ  его использование и реализация для компьютеров платформы   Часть материалов вошедших в данную статью была опубликована в выпуске  год журнала Монитор Дискретная математика Алгоритмы Симметричные системы и блочные шифрынеопрнедоступная ссылка Дата обращения  ноября  Архивировано декабря года Сергей Панасенко Современные алгоритмы шифрования  Журнал  Выпуск   август  Баричев Гончаров Серов                              Выпуск  Январь  стр  с дополнением в выпуске  стр Литератураправить  править кодБаричевСГ ГончаровВВ СеровРЕ Основы современной криптографии  е изд  М ДиалогМИФИ   с                        Симметричные криптосистемыПотоковые шифрыСеть ФейстеляГОСТ  Магма сетьКузнечик  ДругиеЭта статья входит в число хороших статей русскоязычного раздела ВикипедииИсточник  СетьФейстеляКатегории КриптографияСеть ФейстеляСкрытые категории ВикипедияХорошие статьи по криптографииВикипедияХорошие статьи по математикеВикипедияХорошие статьи по алфавитуСтраницы использующие волшебные ссылки НавигацияПерсональные инструментыВы не представились системеОбсуждениеВкладСоздать учётную записьВойтиПространства имёнСтатьяОбсуждениеВариантыПросмотрыЧитатьПравитьПравить кодИсторияЕщёПоиск    Навигация    Заглавная страницаРубрикацияУказатель АЯИзбранные статьиСлучайная статьяТекущие события    Участие    Сообщить обошибкеСообществоФорумСвежие правкиНовые страницыСправкаПожертвовать    Инструменты    Ссылки сюдаСвязанные правкиСлужебные страницыПостоянная ссылкаСведения остраницеЭлемент ВикиданныхЦитировать страницу    Печатьэкспорт    Создать книгуСкачать как Версия для печати    На других языках      УкранськаПравить ссылки Эта страница в последний раз была отредактирована  января  в Текст доступен по лицензии    в отдельных случаях могут действовать дополнительные условияПодробнее см Условия использования зарегистрированный товарный знак некоммерческой организации   Политика конфиденциальностиОписание ВикипедииОтказ от ответственностиСвяжитесь с намиРазработчикиСтатистикаЗаявление о кукиМобильная версия                   Шаблон           ШаблонХорошаястатья           ШаблонПримечания           Шаблон           Шаблон            ШаблонСимметричныекриптоалгоритмы            Шаблон            Шаблон            Шаблон       Сергей Геннадьевич Баричев Сергей Геннадьевич Баричев            Владимир Васильевич Гончаров Владимир Васильевич Гончаров            Роман Евгеньевич Серов Роман Евгеньевич Серов           ДиалогМИФИ                                                                         